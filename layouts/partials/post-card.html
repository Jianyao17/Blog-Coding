{{- $title := .Params.title | default "Default Title" -}}
{{- $desc  := .Params.desc | default "Default desc" -}}
{{- $class := .class | default "hx-aspect-auto md:hx-aspect-[1.1/1] max-md:hx-min-h-[340px]" -}}
{{- $image := .Params.mainImg | default "/default-image.jpg" -}}
{{- $imageClass := .imageClass | default "hx-top-[40%] hx-left-[24px] hx-w-[180%] sm:hx-w-[110%] dark:hx-opacity-80" -}}
{{- $style := .style | default "background: radial-gradient(ellipse at 50% 80%,rgba(194,97,254,0.15),hsla(0,0%,100%,0));" -}}
{{- $icon := .icon | default "" -}}
{{- $link := .link | default "#" -}}

{{- $external := hasPrefix $link "http" -}}
{{- $href := cond (strings.HasPrefix $link "/") ($link | relURL) $link -}}
{{- $image = resources.Get (printf "%s%s" "img/" $image) -}}
{{- $permalink := .Permalink | default "/"}}

<div
  {{ with $style }}style="{{ . | safeCSS }}"{{ end }}
  class="{{ $class }} hextra-feature-card not-prose hx-block hx-relative hx-overflow-hidden hx-rounded-3xl hx-border hx-border-gray-200 hover:hx-border-gray-300 dark:hx-border-neutral-800 dark:hover:hx-border-neutral-700 before:hx-pointer-events-none before:hx-absolute before:hx-inset-0 before:hx-bg-glass-gradient"
>
  <div class="hx-relative hx-w-full hx-p-6">
    <a {{ with $link }}href="{{ $href }}" {{ with $external }} target="_blank" rel="noreferrer"{{ end }}{{ end }}>
      <h3 class="hx-text-xl hx-font-medium hx-leading-6 hx-mb-2 hx-flex hx-items-center">
        {{ with $icon -}}
          <span class="hx-pr-2">
            {{- partial "utils/icon.html" (dict "name" . "attributes" "height=1.5rem") -}}
          </span>
        {{ end -}}
        <span>{{ $title }}</span>
      </h3>
    </a>
    <div class="hx-flex hx-flex-column hx-align-middle">
      {{ with .Params.tags }}
        {{ range . }}
          {{- partial "tag.html" 
            (dict "content" .
            "class" "hx-p-1 hx-text-xl"
            "link" (printf "tags/%s" (urlize .))
            "border" true )
          -}}
        {{ end }}
      {{ end }}
    </div>
  </div>
  {{- with $image -}}
    <a {{ with $link }}href="{{ $href }}" {{ with $external }} target="_blank" rel="noreferrer"{{ end }}{{ end }}>
      <img src="{{ . }}" class="hx-absolute hx-max-w-none hx-rounded-md {{ $imageClass }}" alt="{{ $title }}" loading="lazy"/>
    </a>
  {{- end -}}
</div>
